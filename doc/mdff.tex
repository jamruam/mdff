%MDFF documentation
\documentclass[a4paper]{article}
\usepackage{lscape}
\usepackage{geometry}
\usepackage{chngpage}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{multirow}
\usepackage{array}
\usepackage{longtable}
\usepackage{color}
\usepackage{amssymb}
\usepackage{amsmath}


%##############################################
%new commands
%##############################################
\newcommand{\MDFF}{{\sc MDff}}
\newcommand{\FMV}{{\sc fmv}}
\newcommand{\wiki}{\textcolor{red}{[wiki]}} 
\newcommand{\addref}{\textcolor{blue}{[ref]}}

\newenvironment{changemargin}[2]{\begin{list}{}{%
\renewcommand{\arraystretch}{4.0}
\setlength{\topsep}{0pt}%
\setlength{\leftmargin}{0pt}%
\setlength{\rightmargin}{0pt}%
\setlength{\listparindent}{\parindent}%
\setlength{\itemindent}{\parindent}%
\setlength{\parsep}{0pt plus 1pt}%
\setlength{\tabcolsep}{1cm}
\setlength{\extrarowheight}{40pt}
\addtolength{\leftmargin}{#1}%
\addtolength{\rightmargin}{#2}%
}\item }{\end{list}}


% math symbol
\def\nn{{\bf n}}
\def\kk{{\bf k}}
\def\rr{{\bf r}}
\def\00{{\bf 0}}


\title{Molecular Dynamics FF, Manual , version 0.2.2}

\begin{document}

\maketitle
\clearpage
\tableofcontents

\clearpage

\section{Aim}

Le but de ce document est de repertorier les differents 
algorithmes utilis\'es par \MDFF. Notamment, definir les 
commandes (TAG) et leurs valeurs par défaut. Mais également, 
les r\'eferences aux codes, articles originaux, livres dont 
sont extraits les diff\'erents algorithmes, ou preciser dans 
le cas contraire (i.e \FMV!) ce que fait la routine point par point. 
Ce travail de documentation permettra de faciliter la d\'ecouverte
de bug qui independamment de ma volont\'e sont (et seront) 
forc\'ement pr\'esents. 

\clearpage

\section{Theory}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Molecular Dynamics\label{sec:MD}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection{Integration\label{sec:integrator}}
\subsubsection{Force-Field}
\paragraph{Binary Mixture Lennard-Jones\label{sec:BMLJ}}
\paragraph{Kob-Andersen model\label{sec:KA}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Optimisation\label{sec:OPT}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Phonons\label{sec:VIB}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Electric-Field Gradient\label{sec:EFG}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Some general definition: NMR oriented}

In solid-state NMR, the  quadrupolar interaction is  characterised by two parameters:
$C_Q$ and $\eta_Q$ (respectively the quadrupolar coupling constant, and  the
quadrupolar asymmetry), which are both defined from the  three principal  components
of the diagonal  EFG tensor  ($\bf{V}$), by relations:
\begin{equation}
  \label{eq:quad}
 C_Q=\frac{e|Q|}{h}|V_{zz}| ,\;\;\;\;\;\; \eta_Q=\frac{V_{yy}-V_{xx}}{V_{zz}}
\end{equation}
where $e$ is the elementary charge, $h$ is the Planck's constant, $Q$
is the quadrupolar  moment and the principal components $V_{ii},\ (i=x,y,z)$ are sorted
such that  $|V_{zz}|  \geqslant |V_{xx}| \geqslant |V_{yy}|$. 
We only consider the parameters $V_{zz}$ and $\eta_Q$ to report the principal
components of the diagonal EFG tensor. Even if, NMR experiments at room temperature, are unable
to determined the sign of the larger principal component~\cite{B-Abragam}, this sign property,
which is explicitly available by DFT calculation, is important to characterise the distribution~\cite{VasconcelosPRB}

In the general  case, the  zero trace  EFG tensor  is not
diagonal,  and it  is  necessary to  defined  three others  parameters
which  define the orientation  of the tensor in a fixed reference frame.
Consequently, the EFG tensor is completely defined by five independent
variables as expected by a symmetric second-rank tensor without trace.
Following Czjzek at al.~\cite{PRB.23.2513}, we define five real parameters
$U_i$ from the Cartesian components of the EFG tensor.
\begin{equation}
  \label{eq:U_i}
  U_1=v_{zz}/2, U_2=\frac{v_{xz}}{\sqrt{3}},U_3=\frac{v_{yz}}{\sqrt{3}},U_4=\frac{v_{xy}}{\sqrt{3}},U_5=\frac{(v_{xx}-v_{yy})}{2\sqrt{3}}  
\end{equation}
The five-dimensional vector ${\bf{U}}=(U_1,\ldots,U_5)$ constitutes a random vector
representative of the EFG tensor distribution of an amorphous solid in a fixed frame
of reference for all the nuclei sites. To get access to the distribution of the two
parameters $V_{zz}$ and $\eta_Q$, it is necessary to diagonalise the EFG tensor from
site to site~\cite{JPCM.10.10715}.


\subsubsection{EFG calculation: Implemented formulas}

Consider a finite number $N$ of point charge particules, the EFG tensor
($\bf{V}$) at the position $\rr_i$ of a particule $i$ due to the
$N-1$ other point charges $q_j$ at distance $\rr_{ij}=\rr_i-\rr_j$.
\begin{equation}
V_{i,\alpha\beta} = - \sum_{j\ne i}^N q_j \bigg( \frac {3 r_{ij,\alpha} r_{ij,\beta} - r_{ij}^2\delta_{\alpha\beta} } {r_{ij}^5} \bigg )
\label{eq:EFG}
\end{equation}
where  $\alpha$ end $\beta$ are the cartesian components, $\delta_{\alpha\beta}$
is the Kronecker delta.
In periodic boundaries conditions, a further summation is added to
Eq.~\ref{eq:EFG} arising from the particules which belong to other cells.
This method is called the direct summation. The EFG tensor by the direct
summation technique is given by
%\begin{widetext}
\begin{equation}
V^{DS}_{i,\alpha\beta} = - \sum_\nn^{n_{max}} \sideset{}{'}\sum^{N}_j \\ q_j\bigg(\frac{3 (r_{ij,\alpha}+n_\alpha) (r_{ij,\beta}+n_\beta) - |\rr_{ij}+\nn|^2\delta_{\alpha\beta} } { |\rr_{ij}+\nn|^5 } \bigg )
\end{equation}
%\end{widetext}
where $\nn$ is an integer vector such $\nn=(n_x,n_y,n_z)L$, the prime indicates
that the $j=i$ term is ommited when $\nn=\00$. In practice a further spherical
radial cutoff $r^{cut}_{efg}$ is applied to the cubic cutoff $n_{max}$ which is set
according to the ratio $r^{cut}_{efg}/L$.

%As the EFG scales as $r^{-3}$, the direct summation technique converge relatively
%fast. For a typical configurations discussed in that paper, we oberved that the EFG
%tensor converged within a spherical radius cutoff of 40 $[\sigma_{AA}]$,
%which corresponds to $n_{max}=$~4.

The EFG tensor can be also obtained from an Ewald summation
~\cite{ANDP:ANDP19213690304,B-ALLEN_TILDESLEY} like technique.
The main advantage of this approach is the rapid convergence of
the k-space summation compared to the direct summation only technique.
%Ici on suit la notation de Nymand and Linse(en partie), mais les equations
% correspondent aux equations implementees dans MDFF. 
The EFG tensor of atom $i$ from the Ewald Sum $V^{ES}_{i,\alpha\beta}$ is
\begin{equation}
V^{ES}_{i,\alpha\beta} = V^{real}_{i,\alpha\beta} + V^{rec}_{i,\alpha\beta}
\label{eq:EFG_ES}
\end{equation}
where $V^{real}_{i,\alpha\beta}$ is the real part contribution given by
\begin{equation}
V^{real}_{i,\alpha\beta} = - \sum^{N}_{j\ne i} q_j (3 r_{ij,\alpha}r_{ij,\beta} - r_{ij}^2\delta_{\alpha\beta} ) ( T_0 + T_1 + T_2 ) 
\end{equation}
with
\begin{eqnarray}
T_0&=& \frac{{\rm erfc}( \alpha r_{ij} )} {r_{ij}^5} \nonumber \\
T_1&=& \frac{2 \alpha \exp(-\alpha^2 r_{ij}^2)}{\sqrt{\pi}r_{ij}^4}  \nonumber \\
T_2&=& \frac{4 \alpha^3 \exp(-\alpha^2 r_{ij}^2)}{3\sqrt{\pi} r_{ij}^2};
\end{eqnarray}
and where $V^{rec}_{i,\alpha\beta}$ is the reciprocal contribution given by
\begin{equation}
V^{rec}_{i,\alpha\beta} = \frac{4\pi}{3V}\sum_{\kk\ne\00} A_k Re\Big[ \sum^N_j q_j e^{i\kk\cdot(\rr_i-\rr_j)} \Big] \Big( 3 k_\alpha k_\beta - k^2\delta_{\alpha\beta} \Big)
\end{equation}
with
\begin{equation}
A_k = \frac{\exp( - k^2 / 4\alpha^2 )}{k^2} 
\end{equation}
In practice, we calculate the charge density $\rho_N(\kk)$ defined in k-space by
\begin{equation}
\rho_N(\kk) = \sum^N_j q_j e^{i\kk\rr_j}
\end{equation}
only once at the beginning, and for each $i$ particule and k-point mesh
we calculate $e^{i\kk\rr_i} \rho^*_N(\kk)$ where $*$ denotes the complex conjugate.
The k-space summation runs over all k-points defined by the vector
\begin{eqnarray}
\kk=2\pi(n_x/L,n_y/L,n_z/L) \\
{\rm with}\; |n_x|,|n_y|,|n_z| < n_{max}.
\end{eqnarray}
The convergence of the EFG obtained by the Ewald Summation technique
depends on two main parameters, the Ewald screening parameter $\alpha$
and on the k-space cut-off $k_{max}=2\pi n_{max}/L$.

In the direct summation procedure, there is no need to use the minimum
 image convention as all the neighbour cells are explicitely take into account.
In the real part of the Ewald summation, however, the minimum image convention
is used. the screening parameter $\alpha$ should choose such that that only particles
in the primary box need to be considered when calculating the real space sum.
This cutoff is then implictely set to half of the box size.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Radial distribution function\label{sec:GR}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Verlet list\label{sec:vnlist}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Units \label{sec:units}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Miscellaneous \label{sec:misc}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Usage}

\MDFF~only needs one input file usually called control.F~\footnote{the .F extension permits to get nice colors with vim} 

\subsection{Minimum settings: the input file}

The input file is composed of different sections. 
Each section is defined by  \&SECTIONNAME and \&END.
Everything outside the sections is ignored.
\\
\\
In \MDFF, five sections are always required :

\begin{itemize}
\item \&controltag ... \&end $\rightarrow$ General control parameters for calculation 
\item \&mdtag ... \&end      $\rightarrow$ General Molecular dynamics parameters.
\item \&configtag ... \&end  $\rightarrow$ Information on the configuration
\item \&fieldtag ... \&end   $\rightarrow$ Set the Force-Field.
\item \&proptag ... \&end    $\rightarrow$ Calculation of properties
\end{itemize}

Using this minimum settings (5 empty sections) the code runs with default values.
It correspond to a molecular dynamics trajectory of 10 unit of times of a fcc lennard-jones 
crystal (256 atoms) at $\rho=$1.0 at $T=$1.0. In the next sextion we show the standard output of this minimum setting. 

\clearpage
\subsection{Minimum setting: standart output}
\begin{verbatim}
                            \\|//                    
                           -(o o)-                           
========================oOO==(_)==OOo========================
          ____    ____  ______   ________  ________  
         |_   \  /   _||_   _ `.|_   __  ||_   __  | 
           |   \/   |    | | `. \ | |_ \_|  | |_ \_| 
           | |\  /| |    | |  | | |  _|     |  _|    
          _| |_\/_| |_  _| |_.' /_| |_     _| |_     
         |_____||_____||______.'|_____|   |_____|    
  
=============================================================

MOLECULAR DYNAMICS ...for fun                 
mdff.0.2.0
parallel version
filipe.manuel.vasconcelos@gmail.com  
Running on   1 nodes                  
time     : 2011/11/05    15:50:14
calc     : md                                                          

=============================================================

periodic boundary conditions in cubic cell     
verlet list used 
units reduced by the number of atom
dynamic calculation
NVE ensemble --- velocity verlet integrator    
with equilibration:             
berendsen scaling ( is not canonical ...and so NVE)
number of steps                      =         10
timestep                             = .10000E-02
time range                           = .10000E-01
temperature                          =    1.00000
number of equilibration steps        =         10
equilibration period                 =          1
Berendsen thermo time scale          = .10000E-02
tauberendsen = dt -> simple rescale
print thermo  periodicity            =          1

=============================================================

structure generated from the code
Face-centered cubic structure :  4x  4x  4  
system                               : fcc                                                         
natm                                 =        256
cell parameter                       =     6.3496
volume                               =   256.0000
density                              =     1.0000
distance check subroutine
smallest distance =   1.12

=============================================================

force field information :                      
no masses are implemented                      
LENNARD-JONES                  

       eps    /    / sigma* \ q       / sigma*  \ p \
 V = ------- |  p | ------- |    - q | -------- |   |
      q - p   \    \   r    /         \    r    /   /

USER DEFINED MODEL                             
cutoff  =    2.50000

A-A interactions:
sigmaAA =    1.00000
epsAA   =    1.00000
qAA     =   12.00000
pAA     =    6.00000
long range correction :         -0.535433102
 
paralelisation - atom decomposition
rank    0 atom    1 to  256
=============================================================
... MD output
=============================================================

                 TOTAL :  cpu time     0.15
                    MD :  cpu time     0.01

main subroutines:
MD:
    engforce_bmlj      :  cpu time     0.01
    engforce_coul_DS   :  cpu time     0.00
    vnlistcheck        :  cpu time     0.00
=============================================================
\end{verbatim}

\subsection{Miniumim setting : Output files}
For this minimum setting, the code generates 4 files:

\begin{itemize}
\item OUTFF  : close to the standard output
\item OSZIFF : thermodynamic parameters 
\item TRAJFF : trajectory file (empty in this case) 
\item CONTFF : final configuration
\end{itemize}
theses files and other output files are described in a following section.

\subsection{Input file : Description}

%###################################################################################################"
%                                         CONTROLTAG
%###################################################################################################"
\subsubsection{\&controltag }

Where : \verb?SUBROUTINE control_init? in \verb?control.f90?
\newline

\begin{longtable}{l|c|m{8cm}|m{2cm}}
\hline
\hline
Parameter        &  Type              &          Short Description                                                          & Default value \\
\hline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lbmlj?     & (LOGICAL)          &  set the binary mixture lennard-jones potential (see section~\ref{sec:BMLJ})        & \verb?.TRUE.?  \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lcoulomb?  & (LOGICAL)          &  set coulombic potentials (to be tested)                                            & \verb?.FALSE.? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lvnlist?   & (LOGICAL)          &  use verlet neighbour list (see section~\ref{sec:vnlist})                           & \verb?.TRUE.?  \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lstatic?   & (LOGICAL)          &  static calculation                                                                 & \verb?.FALSE.? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lpbc?      & (LOGICAL)          &  use periodic boundary conditions (if .FALSE. should be tested)                     & \verb?.TRUE.?  \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lreduced?  & (LOGICAL)          &  \newline reduced the output quantities by the total number of particules \newline

                                         Comment: this has nothing to do with the units of the calculated quantities
					 Units are discussed in section \ref{sec:units} \newline                            & \verb?.TRUE.? \\ 
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lshiftpot? & (LOGICAL)          &  use a shifted potential (maybe redundant with ctrunc)                              & \verb?.TRUE.? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ltest?     & (LOGICAL)          &  get round of the main code (for test purpose only)                                 & \verb?.FALSE.? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lrestart?   & (LOGICAL)         &  restart calculation read previous positions and velocities                         & \verb?.FALSE.? \\
\hline
\rule[-2.5cm]{0cm}{5cm}
\verb?calc?      & (CHARACTER)        & \newline \verb?'md'?  : molecular dynamics simulation (see section~\ref{sec:MD}) \newline

                                        \verb?'opt'? : unconstrained optimization of configuation saved in TRAJFF file 
					(see section~\ref{sec:OPT}) \newline

					\verb?'vib'? : 'vib+fvib', 'vib+gmod', 'vib+band', 'vib+dos' : phonons related 
					(see section~\ref{sec:VIB})\newline

					\verb?'efg'? : Electric Field Gradient calculation from configuration in TRAJFF 
					(see section~\ref{sec:EFG})\newline

					\verb?'efg+acf?' : EFG auto-correlation function from EFGALL file 
					(see section~\ref{sec:EFG})\newline

					\verb?'gr'? : radial distribution function of configurations in TRAJFF
					(see section~\ref{sec:GR}) \newline    & \verb?'md'?   \tabularnewline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?dgauss?    & (CHARACTER)        & \newline algorithm for gaussian distribution (no fondamental differences test purpose only) 
                                        (see section~\ref{sec:misc}) \newline  

                                        \verb?'boxmuller_basic'? : also known as the cartesian form  \newline

					\verb?'boxmuller_polar'? : supposed to be faster than the basic method because it is 
					simpler to compute.     \newline

					\verb?'knuth'? : knuth algorithm cited by~\cite{B-ALLEN_TILDESLEY} \newline          & \verb?'boxmuller_basic'? \tabularnewline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?longrange? & (CHARACTER)        & \newline algorithm for long-range interactions. It will be used for coulombic potential 
                                        calculation and Electric-Field Gradient calculation, if both are set together. \newline

					\verb?'direct'? : Direct summation (can be used for EFG but difficult to converge for columbic potential) \newline

					\verb?'ewald'? : Ewald summation technique \newline                                &  \verb?'ewald?'      \tabularnewline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?cutoff?    & (DBLE)             &  real-space cut-off for lennard-jones potentials                                   & \verb?2.5?\\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?skindiff?  & (DBLE)             &  verlet-list cutoff ( cutoff + skindiff )                                          & \verb?0.1?\\
\hline
\hline
\end{longtable}

%###################################################################################################"
%                                         MDTAG
%###################################################################################################"
\subsubsection{\&mdtag}

Where : \verb?SUBROUTINE md_init? in \verb?md.f90?
\newline

\begin{longtable}{l|c|m{8cm}|m{2cm}}
\hline
\hline
Parameter        &  Type              &          Short Description                                                          & Default value \\
\hline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ltraj?         & (LOGICAL)      &  save trajectory in file TRAJFF                                                     & \verb?.FALSE.? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?integrator?    & (CHARACTER)    &  \newline algorithm for dynamic integration (see section~\ref{sec:integrator}) \newline                   

                                         \verb?'nve-vv'? : NVE velocity-verlet \newline
					  
					 \verb?'nve-lf'? : NVE leap-frog \newline
					   
				         \verb?'nve-be'? : NVE beeman \newline
					 
					 \verb?'nvt-and'?: NVT Andersen \newline
					 
					 \verb?'nvt-nh'? : NVT Nosé-Hoover \newline
					 
					 \verb?'nvt-nhc2'? : NVT Nosé-Hoover two chains \newline
					 
					 \verb?'nve-lfq'? : NVE leap-frog +  equilibration \newline                         & \verb?'nve-vv'? \tabularnewline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?setvel?        & (CHARACTER)    &  \newline velocity distribution \newline 
                                        
					 \verb?'MaxwBoltz'? : Maxwell-Boltzmann distribution \newline 

					 \verb?'uniform'?   : Uniform distribution (test purpose) \newline                  & \verb?'MaxwBoltz'? \tabularnewline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?npas?          & (INTEGER)      &  total number of time steps                                                         & \verb?10?    \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nequil?        & (INTEGER)      &  total number of equilibration steps                                                & \verb?10? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nequil_period? & (INTEGER)      &  equilibration period                                                               & \verb?1? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nprint?        & (INTEGER)      &  print thermo info to standard output and OUTFF (period)                            & \verb?1? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?fprint?        & (INTEGER)      &  print thermo info to file OSZIFF (period)                                          & \verb?1? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?itraj_start?   & (INTEGER)      &  write trajectory from step \verb?itraj_start?                                      & \verb?1? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?itraj_period?  & (INTEGER)      &  write trajectory each \verb?itraj_period? steps                                    & \verb?10000? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?spas?          & (INTEGER)      &  save configuration each \verb?spas? steps in file CONTFF                           & \verb?1000? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?dt?            & (DBLE)         &  time step for integration                                                          & \verb?0.001? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?temp?          & (DBLE)         &  temperature                                                                        & \verb?1.0?\\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nuandersen?    & (DBLE)         &  characteristic frequency in andersen thermostat                                    & \verb?NULL? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?tauberendsen?  & (DBLE)         &  characteristic time in berendsen thermostat (simple rescale if tauberendsen = dt ) & \verb?dt? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?Qnosehoover?   & (DBLE)         &  Q parameter in Nose-Hoover two chains                                              & \verb?NULL? \\
\hline
\hline
\end{longtable}

%###################################################################################################"
%                                         CONFIGTAG
%###################################################################################################"
\subsubsection{\&configtag}

Where : \verb?SUBROUTINE config_init? in \verb?config.f90?
\newline

\begin{longtable}{l|c|m{8cm}|m{2cm}}
\hline
\hline
Parameter        &  Type              &          Short Description                                                          & Default value \\
\hline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lgenconf?  & (LOGICAL)          & \newline if \verb?.TRUE.? generate the configuration \newline

                                      if \verb?.FALSE.? read configuration from file \newline

				      POSFF if \verb?calc='md'? \newline

				      TRAJFF if \verb?calc='opt'?or \verb?'efg'? \newline

				      ISCFF if \verb?calc='vib'?  \newline                                                  & \verb?.TRUE.? \tabularnewline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lfcc?      & (LOGICAL)         & for \verb?lgenconf=.TRUE.?  generate face-centered cubic lattice                     & \verb?.TRUE.? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lsc?       & (LOGICAL)         & for \verb?lgenconf=.TRUE.?  generate simple cubic lattice (primitive)                & \verb?.FALSE.? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lbcc?      & (LOGICAL)         & for \verb?lgenconf=.TRUE.?  generate body-centered cubic lattice                     & \verb?.FALSE.? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?system?    & (CHARACTER)       & system name                                                                          & \verb?'UNKNOWN'? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?struct?    & (CHARACTER)       & \newline crystal structure for fcc (only make sense for \verb?ntype=2?) \newline
           
	                              \verb?'NaCl'? \newline
				      
				      \verb?'random'? \newline                                                              & \verb?'random'? \tabularnewline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ntype?     & (INTEGER)         & number of types \verb?=1? or \verb?=2?                                               & \verb?1? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?natm?      & (INTEGER)         & total number of atoms                                                                & \verb?NULL? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ncell?     & (INTEGER)         & number of cell in 1D (with \verb?lfcc?,\verb?lsc?,\verb?lbcc?)                       & \verb?4? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?xna?       & (DBLE)            & relative composition of atom of type A                                               & \verb?1.0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?xnb?       & (DBLE)            & relative composition of atom of type B                                               & \verb?0.0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?rho?       & (DBLE)            & density number ( if \verb?box=0.0? )                                                 & \verb?NULL? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?box?       & (DBLE)            & lattice parameter ( if \verb?rho=0.0? )                                              & \verb?NULL? \\
\hline
\hline
\hline
\end{longtable}

%###################################################################################################"
%                                         FIELDTAG
%###################################################################################################"

\subsubsection{\&fieldtag}

Where : \verb?SUBROUTINE field_init? in \verb?field.f90?
\newline

\begin{longtable}{l|c|m{8cm}|m{2cm}}
\hline
\hline
Parameter          &  Type              &          Short Description                                                          & Default value \\
\hline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lKA?         &  (LOGICAL)         & use the Kob-Andersen model for BMLJ (see \S \ref{sec:KA})                           & \verb?.FALSE.? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ctrunc?      &  (CHARACTER)       & \newline truncation and shift of the potential \newline 

                                         \verb?'linear'?: linear correction (potential discontinuity at $r=r_{cut}$) \newline 
					 
                   			 \verb?'quadratic'?: quadratic correction ( potential and force 
					 discontinuity at $r=r_{cut}$) \newline                                               & \verb?'linear'? \tabularnewline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ncelldirect? &  (INTEGER)         & \newline number of neighboring cells in the direct summation 
                                         (total number of cells $=ncelldirect^3$ \newline 

                                          for \verb?lcoulomb=.TRUE.? and \verb?longrange='direct'?  \newline                  
					  
					  not efficient for coulombic interaction                                             & \verb?2? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ncellewald?  &  (INTEGER)         & \newline number of kpoints in the reciprocal contribution of the Ewald summation
                                         (total number of cells $=ncellewald^3$ \newline                                      
					 
					 for \verb?lcoulomb=.TRUE.? and \verb?longrange='ewald'?  \newline                    & \verb?10? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?alphaES?     &  (DBLE)            & Ewald screening parameter                                                           & \verb?1.0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?epsXY?       &  (DBLE)            & depth of the potential well of the Lennard jones potential with XY = AA, BB or AB   & \verb?1.0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?sigmaXY?     &  (DBLE)            & finite distance at which the inter-particle potential is zero with 
                                          XY = AA, BB or AB                                                                   & \verb?1.0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?qljXY?       &  (DBLE)            & exponent of the repulsive part with XY = AA, BB or AB                               & \verb?12? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?pljXY?       &  (DBLE)            & exponent of the attractive part with XY = AA, BB or AB                              & \verb?6? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?mX?          &  (DBLE)            & mass of the particule with X= A or B (not used yet)                                 & \verb?1.0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?qX?          &  (DBLE)            & charge of the particule with X= A or B                                              & \verb?qA = 1.0?\newline\verb?qB =-1.0?\\
\hline
\hline
\end{longtable}

%###################################################################################################"
%                                         PROPTAG
%###################################################################################################"
\subsubsection{\&proptag}

Where : \verb?SUBROUTINE prop_init? in \verb?prop.f90?
\newline

\begin{longtable}{l|c|m{8cm}|m{2cm}}
\hline
\hline
Parameter          &  Type              &          Short Description                                                          & Default value \\
\hline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lefg?        & (LOGICAL)          & calculate electric field gradient on the fly during the md                          & \verb?.FALSE.? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lgr?         & (LOGICAL)          & calculate radial distribution function on the fly during the md                     & \verb?.FALSE? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lstrfac?     & (LOGICAL)          & calculate static structural factor on the fly during the md                         & \verb?.FALSE? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lmsd?        & (LOGICAL)          & calculate mean square displacment on the fly during the md                          & \verb?.FALSE? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lvacf?       & (LOGICAL)          & calculate velocity autocorrelation function on the fly during the md                & \verb?.FALSE? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nprop_start? & (INTEGER)          & calculate properties from step \verb?nprop_start?                                   & \verb?0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nprop?       & (INTEGER)          & calculate properties each \verb?nprop? step ( for lgr and efg not sure anymore)     & \verb?1? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nprop_print? & (INTEGER)          & print properties each \verb?nprop_print?                                            & \verb?nprop? \\
\hline
\hline
\end{longtable}

%###################################################################################################"
%                                         OPTTAG
%###################################################################################################"
\subsubsection{\&opttag}

Where : \verb?SUBROUTINE opt_init? in \verb?opt.f90?
\newline

\begin{longtable}{l|c|m{8cm}|m{2cm}}
\hline
\hline
Parameter        &  Type              &          Short Description                                                          & Default value \\
\hline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?optalgo?   & (CHARACTER)        & \newline choose unconstrained optimization algorithm \newline 

                                        \verb?'sastry'? : Linear minimisation via cubic extrapolation of potential 
					Original author S. Sastry JNCASR \newline

					\verb?'lbfgs'? : Limited memory BFGS method for large scale optimisation
					Author: J. Nocedal~\addref  \newline 
					 
					\verb?'m1qn3'? : M1QN3, Version 3.3, October 2009
					Authors: Jean Charles Gilbert, Claude Lemarechal, INRIA.~\addref \newline            & \verb?sastry? \tabularnewline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ncopt?     & (INTEGER)          & number of configurations in TRAJFF                                                   & \verb?0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nskipopt?  & (INTEGER)          & number of configurations skipped in the beginning of TRAJFF                          & \verb?0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nmaxopt?   & (INTEGER)          & number of configurations to be optimize                                              & \verb?1? \\
\hline
\hline
\end{longtable}

%###################################################################################################"
%                                         VIBTAG
%###################################################################################################"
\subsubsection{\&vibtag}

Where : \verb?SUBROUTINE vib_init? in \verb?vib.f90?
\newline

\begin{longtable}{l|c|m{8cm}|m{2cm}}
\hline
\hline
Parameter            &  Type              &          Short Description                                                          & Default value \\
\hline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lwrite_vectff? & (LOGICAL)          & write the vector field (i.e eigenvectors) in VECTFF file                            & \verb?.FALSE.?  \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ncvib?         & (INTEGER)          & number of configurations in ISCFF to be analysed                                    & \verb?0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ngconf?        & (INTEGER)          & number of configurations generated with \verb?calc='vib+gmod'?                      & \verb?0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?imod?          & (INTEGER)          & if \verb?calc='vib+gmod'? generate the mode \verb?imod?                             & \verb?4? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nkphon?        & (INTEGER)          & number of kpoint between ks and kf used when calc = 'vib+band'                      & \verb?NULL? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?resdos?       & (DBLE)              & resolution in vibrational density of states distribution                            & \verb?1.0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?omegamax?     & (DBLE)              & maximum value in dos                                                                & \verb?100.0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ksx,ksy,ksz?  & (DBLE)              & first kpoint & \verb?NULL? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?kfx,kfy,kfz?  & (DBLE)              & last kpoint  & \verb?NULL? \\
\hline
\hline
\end{longtable}

%###################################################################################################"
%                                         EFGTAG
%###################################################################################################"

\subsubsection{\&efgtag}

Where : \verb?SUBROUTINE efg_init? in \verb?efg.f90?
\newline

\begin{longtable}{l|c|m{8cm}|m{2cm}}
\hline
\hline
Parameter              &  Type              &          Short Description                                                          & Default value \\
\hline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lefgprintall?    & (LOGICAL)          &  whether or not we want to print all the efg for each atoms and 
                                               configurations in file EFGALL                                                      & \verb?.FALSE.? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?lefg_it_contrib? & (LOGICAL)          & if one wants to get the contribution to EFG separated in types 
                                              (only \verb?'direct'? and test purpose)                                             & \verb?.FALSE.? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ncefg?           & (INTEGER)          & number of configurations read in TRAJFF for EFG calculation ( \verb?calc='efg'? )    & \verb?0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ntcor?           & (INTEGER)          & maximum number of steps for the efg auto-correlation function( \verb?calc='efg+acf'?)& \verb?10? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ncellewald?      & (INTEGER)          & \newline number of kpoints in the reciprocal contribution of the Ewald summation
                                              (total number of cells $=ncellewald^3$ \newline
					 
                                              for \verb?longrange='ewald'?  \newline                                               & \verb?0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ncelldirect?     & (INTEGER)          & \newline number of neighboring cells in the direct summation
                                              (total number of cells $=ncelldirect^3$ \newline
					 
                                              for \verb?longrange='direct'?  only \newline                                         & \verb?0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?cutefg?          & (DBLE)             & cut-off distance for efg calculation in for direct summation 
                                              (\verb?longrange='direct'?) & \verb?30.0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?alphaES?         & (DBLE)             & Ewald sum screening parameter                                                        & \verb?1.0? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?resvzz?          & (DBLE)             & resolution in $V_{zz}$ distribution                                                       & \verb?0.1? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?reseta?          & (DBLE)             & resolution in $\eta_Q$ distribution                                                       & \verb?0.1? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?resu?            & (DBLE)             & resolution in $U_i$ ditribution                                                         & \verb?0.1? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?vzzmin?          & (DBLE)             & minimum value of $V_{zz}$ distribution which is then between [vzzmin, -vzzmin]            & \verb?-4.0? \\ 
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?umin?            & (DBLE)             & minimum value of umin distribution which is then between [umin, -umin]               & \verb?-4.0? \\
\hline
\hline
\end{longtable}

%###################################################################################################"
%                                         MSDTAG
%###################################################################################################"

\subsubsection{\&msdtag}

Where : \verb?SUBROUTINE msd_init? in \verb?msd.f90?
BE CAREFUL !!! NOT HEAVELY TESTED !
\newline

\begin{longtable}{l|c|m{8cm}|m{2cm}}
\hline
\hline
Parameter        &  Type              &          Short Description                                                          & Default value \\
\hline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nblock?    & (INTEGER)          & ???????? I forgot ;)                                                                & \verb?10? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?ibmax?     &  (INTEGER)         & ???????? I forgot ;)                                                                & \verb?20? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?tdifmax?   & (DBLE)             & ???????? I forgot ;)                                                                & \verb?100.0? \\
\hline
\hline
\end{longtable}

%###################################################################################################"
%                                         GRTAG
%###################################################################################################"

\subsubsection{\&grtag}

Where : \verb?SUBROUTINE control_init? in \verb?radial_distribution.f90?
\newline

\begin{longtable}{l|c|m{8cm}|m{2cm}}
\hline
\hline
Parameter        &  Type              &          Short Description                                                          & Default value \\
\hline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nc?        & (INTEGER)          & number of configurations to read in TRAJFF                                          & \verb?0? \\
\rule[-0.75cm]{0cm}{1.5cm}
\verb?nskip?     & (INTEGER)          & number of configurations skipped in the beginning of TRAJFF                         & \verb?0? \\
\rule[-0.75cm]{0cm}{1.5cm}
\verb?resg?      & (DBLE)             & resolution in the radial distribution function                                      & \verb?0.1? \\
\hline
\hline
\end{longtable}

%###################################################################################################"
%                                         VACFTAG
%###################################################################################################"
\subsubsection{\&vacftag}

Where : \verb?SUBROUTINE vacf_init? in \verb?vacf.f90?
BE CAREFUL
\newline

\begin{longtable}{l|c|m{8cm}|m{2cm}}
\hline
\hline
Parameter        &  Type              &          Short Description                                                          & Default value \\
\hline
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?it0?       & (INTEGER)          & ???????? I forgot ;)                                                                & \verb?1? \\
\hline
\rule[-0.75cm]{0cm}{1.5cm}
\verb?tdifmax?   & (DBLE)             & ???????? I forgot ;)                                                                & \verb?100.0? \\ 
\hline
\hline
\end{longtable}


%###################################################################################################"
%                                         OUTFILE DESCRIPTION
%###################################################################################################"
\section{Output files description}

\bibliography{mdff}
\bibliographystyle{amsplain}

\end{document}
